<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="sub-body">
    <!-- <h1 id="firstDiscription">Just say to this.</h1> -->
    <div id="header">
    </div>
    <div id="main">
    </div>
    <div class="test">
    </div>
    <div class="btns">
      <button id="start-btn">start</button>
      <button id="stop-btn">stop</button>
    </div>
  </div>
</body>

<script>
  const startBtn = document.querySelector('#start-btn');
  const stopBtn = document.querySelector('#stop-btn');

  startBtn.onclick = () => {
    recognition.start();
  }
  stopBtn.onclick = () => {
    recognition.stop();
  }


  let makeHeader = document.createElement('header');
  let makeSomething = document.createElement('section')
  let makeMain = document.createElement('section');
  let makeInputName = document.createElement('input')
  let makeInputMail = document.createElement('input')



// traial
  var siteData = {
    makeHeader,
    makeMain,
    makeSomething,
    makeInputName,
    makeInputMail
  };


  function test (text) { 
    let makeObject = document.querySelector('.test');
    console.log(makeObject)
    siteData.makeSomething.style.cssText = "height: 100px;";
    let ababab = siteData.makeSomething
    makeObject.appendChild(ababab)
    changeTheColor(text, ababab);
  }

  function changeTheColor (theWords, changingThing) {
    if (theWords.includes('青')) {
      changingThing.style.backgroundColor = "#75a0d2";
    } else if (theWords.includes('赤')) {
      changingThing.style.backgroundColor = "#da4a4a";
    } else if (theWords.includes('緑')) {
      changingThing.style.backgroundColor = "#75d27d";
    } else {
      console.log('from second else')
      changingThing.style.backgroundColor = "#EBECF0";
    }
  }
// by here

  function createHeader (text) {
    let mainHeader = document.getElementById('header');
    console.log('from the header');
    let header = siteData.makeHeader
    header.className = "madeHeader";
    header.style.cssText = "height: 100px;";
    mainHeader.appendChild(header);
    changeTheColor(text, header);
    // const btns = document.querySelector('.btns');
    // btns.style.cssText = "opacity: 0.5;"
  }
  
  let main = document.getElementById('main');

  function createMain (text) {
    let mainSection = siteData.makeMain
    mainSection.className = "contents";
    mainSection.style.cssText = "height: 95%;";
    main.appendChild(mainSection);
    changeTheColor(text, mainSection);
  }



  let form = document.createElement('form')
  let labelForName = document.createElement('label')
  let labelForMail = document.createElement('label')

  function createForm (text) {
    console.log('formFunc')
    let formBack = siteData.makeMain
    let label = document.createElement('label')
  
    if (text.includes('名前')) {
      form.appendChild(labelForName)
      defineInputName(labelForName, 'お名前', text)
    } else if (text.includes('メールアドレス')) {
      form.appendChild(labelForMail)
      defineInputName(labelForMail, 'メールアドレス', text)
    } else {
      form.appendChild(label)
      let textIndexNum = text.indexOf("フォーム")
      console.log(textIndexNum)
      if (textIndexNum !== -1) {
        let deleteForm = text.split('フォーム').join('')
        console.log('this is test', deleteForm)
        defineInputName(label, deleteForm, text);
      } else {
        console.log('failed to create')
      }
    }
    formBack.appendChild(form)
  }

  function defineInputName (givenLabel, theWords, colorWords) {
    if (theWords === 'お名前') {
      console.log('nameprop')
      let input = siteData.makeInputName
      actualPuttingInputType(input, givenLabel, theWords);
      changeTheColor(colorWords, input);
    } else if (theWords === 'メールアドレス') {
      console.log('mailprops')
      let input = siteData.makeInputMail
      actualPuttingInputType(input, givenLabel, theWords);
      changeTheColor(colorWords, input);
    } else {
      let input = document.createElement('input')
      actualPuttingInputType(input, givenLabel, theWords);
      changeTheColor(colorWords, input);
    }
  }

  function actualPuttingInputType (inputType, givenLabel, defineWords) {
    inputType.setAttribute("type", "text");
    inputType.setAttribute("placeholder", `${defineWords}`)
    givenLabel.appendChild(inputType);
  }


  SpeechRecognition = webkitSpeechRecognition || SpeechRecognition;
  const recognition = new SpeechRecognition();
  recognition.continuous = true;

  recognition.onresult = (event) => {
    // 改造
    const uttr = new SpeechSynthesisUtterance(event.results[0][0].transcript)
    console.log('1, from recognition', uttr.text)
    usersWords = uttr.text

    if (usersWords.includes('ヘッダー')) {
      createHeader(usersWords);
    } else if (usersWords.includes('メイン')) {
      createMain(usersWords)
    } else if (usersWords.includes('テスト')) {
      test(usersWords)
    } else if (usersWords.includes('フォーム')) {
      createForm(usersWords);
    } else {
      console.log('miss the recognize')
    }
    // recognition.onend = reset;
    // recognition.start();
  }

  // recognition.start();
  
</script>
</html>